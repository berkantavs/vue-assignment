{"ast":null,"code":"import ContactSearch from './ContactSearch';\nimport VueSelect from 'vue-select';\nimport 'flatpickr/dist/flatpickr.css';\nimport FlatPickr from 'vue-flatpickr-component';\nimport { updateRecords } from '../services/appointmentsService';\nexport default {\n  props: [\"allRecords\", 'record', \"contacts\", \"agents\"],\n  components: {\n    ContactSearch,\n    VueSelect,\n    flatPickr: FlatPickr\n  },\n  data() {\n    return {\n      selectedContact: null,\n      appointmentAddress: null,\n      selectedAgent: [],\n      appointmentDate: '',\n      selectedContactId: null,\n      config: {\n        enableTime: true,\n        time_24hr: true\n      }\n    };\n  },\n  mounted() {\n    this.initializeEditForm();\n  },\n  watch: {\n    contacts: 'initializeEditForm'\n  },\n  computed: {\n    agentList() {\n      return this.agents.map(agent => ({\n        id: agent.id,\n        label: `${agent.fields.agent_name} ${agent.fields.agent_surname}`\n      }));\n    },\n    relatedAppointments() {\n      return this.allRecords.filter(appointment => this.selectedContact.fields.appointments.includes(appointment.id));\n    }\n  },\n  methods: {\n    initializeEditForm() {\n      if (this.contacts && this.record.fields.contact_id) {\n        const contact = this.contacts.find(contact => contact.id === this.record.fields.contact_id[0]);\n        console.log(contact);\n        if (contact) {\n          this.selectedContact = contact;\n        }\n      }\n      if (this.record.fields.appointment_address) {\n        this.appointmentAddress = this.record.fields.appointment_address;\n      }\n      if (this.record.fields.agent_id) {\n        this.selectedAgent = this.record.fields.agent_id.map((id, index) => ({\n          id: id,\n          label: `${this.record.fields.agent_name[index]} ${this.record.fields.agent_surname[index]}`\n        }));\n      }\n      if (this.record.fields.appointment_date) {\n        this.appointmentDate = this.record.fields.appointment_date;\n      }\n    },\n    setContact(contact) {\n      this.selectedContact = contact;\n    },\n    async submitAppointment() {\n      const updatedAppointment = {\n        id: this.record.id,\n        fields: {\n          appointment_date: this.appointmentDate,\n          appointment_address: this.appointmentAddress,\n          contact_id: [this.selectedContact.id],\n          agent_id: this.selectedAgent.map(agent => agent.id)\n        }\n      };\n      try {\n        const response = await updateRecords('Appointments', [updatedAppointment]);\n        console.log('Appointment updated:', response);\n      } catch (error) {\n        console.error('Error updating appointment:', error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["ContactSearch","VueSelect","FlatPickr","updateRecords","props","components","flatPickr","data","selectedContact","appointmentAddress","selectedAgent","appointmentDate","selectedContactId","config","enableTime","time_24hr","mounted","initializeEditForm","watch","contacts","computed","agentList","agents","map","agent","id","label","fields","agent_name","agent_surname","relatedAppointments","allRecords","filter","appointment","appointments","includes","methods","record","contact_id","contact","find","console","log","appointment_address","agent_id","index","appointment_date","setContact","submitAppointment","updatedAppointment","response","error"],"sources":["src/components/EditAppointmentModal.vue"],"sourcesContent":["<template>\n    <div class=\"appointment-modal\">\n        <b-modal hide-backdrop :id=\"'appointment-modal-' + record.id\" hide-footer hide-header-close\n            header-class=\"d-block\" content-class=\"grey-background\">\n            <template #modal-header=\"{}\">\n                <div class=\"text-center\">\n                    <b-icon class=\"me-2\" icon=\"calendar-plus\" font-scale=\"1.1\"></b-icon>\n                    <b>Edit appointment</b>\n                </div>\n            </template>\n            <div class=\"search-contact-area\">\n                <ContactSearch :contacts=\"contacts\" @setContact=\"setContact\" :selectedContactInfo=\"selectedContact\"\n                    :formType=\"'edit'\" />\n            </div>\n            <div class=\"appointment-address-input-area mt-3\">\n                <b-form-input type=\"text\" v-model=\"appointmentAddress\" placeholder=\"Address\"></b-form-input>\n            </div>\n            <div class=\"status-select-box-area mt-3\">\n                <VueSelect multiple v-model=\"selectedAgent\" :options=\"agentList\" placeholder=\"Agent\" />\n            </div>\n            <div class=\"date-selector-area mt-3\">\n                <flat-pickr :model-value=\"appointmentDate\" :config=\"config\"\n                    @update:modelValue=\"appointmentDate = $event\" class=\"form-control\"></flat-pickr>\n            </div>\n            <div class=\"related-appointments-area\" v-if=\"relatedAppointments && relatedAppointments.length > 0\">\n                <b>Related Appointments</b>\n                <div class=\"mt-2\">\n                    <template v-for=\"(relatedAppointment, index) in relatedAppointments\">\n                        <div :key=\"index\">\n                            {{ relatedAppointment }}\n                        </div>\n                    </template>\n                </div>\n            </div>\n            <div class=\"submit-button-area mt-3 text-end\">\n                <b-button variant=\"primary\" @click=\"submitAppointment\">Submit</b-button>\n            </div>\n        </b-modal>\n    </div>\n</template>\n\n<script>\nimport ContactSearch from './ContactSearch';\nimport VueSelect from 'vue-select';\nimport 'flatpickr/dist/flatpickr.css';\nimport FlatPickr from 'vue-flatpickr-component';\nimport { updateRecords } from '../services/appointmentsService';\n\nexport default {\n    props: [\"allRecords\", 'record', \"contacts\", \"agents\"],\n    components: {\n        ContactSearch,\n        VueSelect,\n        flatPickr: FlatPickr,\n    },\n    data() {\n        return {\n            selectedContact: null,\n            appointmentAddress: null,\n            selectedAgent: [],\n            appointmentDate: '',\n            selectedContactId: null,\n            config: {\n                enableTime: true,\n                time_24hr: true,\n            },\n        };\n    },\n    mounted() {\n        this.initializeEditForm();\n    },\n    watch: {\n        contacts: 'initializeEditForm',\n    },\n    computed: {\n        agentList() {\n            return this.agents.map(agent => ({\n                id: agent.id,\n                label: `${agent.fields.agent_name} ${agent.fields.agent_surname}`,\n            }));\n        },\n        relatedAppointments() {\n            return this.allRecords.filter(appointment =>\n                this.selectedContact.fields.appointments.includes(appointment.id)\n            );\n        }\n    },\n    methods: {\n        initializeEditForm() {\n            if (this.contacts && this.record.fields.contact_id) {\n                const contact = this.contacts.find(contact => contact.id === this.record.fields.contact_id[0]);\n                console.log(contact);\n                if (contact) {\n                    this.selectedContact = contact;\n                }\n            }\n            if (this.record.fields.appointment_address) {\n                this.appointmentAddress = this.record.fields.appointment_address;\n            }\n            if (this.record.fields.agent_id) {\n                this.selectedAgent = this.record.fields.agent_id.map((id, index) => ({\n                    id: id,\n                    label: `${this.record.fields.agent_name[index]} ${this.record.fields.agent_surname[index]}`,\n                }));\n            }\n            if (this.record.fields.appointment_date) {\n                this.appointmentDate = this.record.fields.appointment_date\n            }\n        },\n        setContact(contact) {\n            this.selectedContact = contact;\n        },\n\n        async submitAppointment() {\n            const updatedAppointment = {\n                id: this.record.id,\n                fields: {\n                    appointment_date: this.appointmentDate,\n                    appointment_address: this.appointmentAddress,\n                    contact_id: [this.selectedContact.id],\n                    agent_id: this.selectedAgent.map(agent => agent.id)\n                }\n            };\n\n            try {\n                const response = await updateRecords('Appointments', [updatedAppointment]);\n                console.log('Appointment updated:', response);\n            } catch (error) {\n                console.error('Error updating appointment:', error);\n            }\n        }\n    }\n};\n</script>\n"],"mappings":"AA0CA,OAAAA,aAAA;AACA,OAAAC,SAAA;AACA;AACA,OAAAC,SAAA;AACA,SAAAC,aAAA;AAEA;EACAC,KAAA;EACAC,UAAA;IACAL,aAAA;IACAC,SAAA;IACAK,SAAA,EAAAJ;EACA;EACAK,KAAA;IACA;MACAC,eAAA;MACAC,kBAAA;MACAC,aAAA;MACAC,eAAA;MACAC,iBAAA;MACAC,MAAA;QACAC,UAAA;QACAC,SAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,kBAAA;EACA;EACAC,KAAA;IACAC,QAAA;EACA;EACAC,QAAA;IACAC,UAAA;MACA,YAAAC,MAAA,CAAAC,GAAA,CAAAC,KAAA;QACAC,EAAA,EAAAD,KAAA,CAAAC,EAAA;QACAC,KAAA,KAAAF,KAAA,CAAAG,MAAA,CAAAC,UAAA,IAAAJ,KAAA,CAAAG,MAAA,CAAAE,aAAA;MACA;IACA;IACAC,oBAAA;MACA,YAAAC,UAAA,CAAAC,MAAA,CAAAC,WAAA,IACA,KAAAzB,eAAA,CAAAmB,MAAA,CAAAO,YAAA,CAAAC,QAAA,CAAAF,WAAA,CAAAR,EAAA,CACA;IACA;EACA;EACAW,OAAA;IACAnB,mBAAA;MACA,SAAAE,QAAA,SAAAkB,MAAA,CAAAV,MAAA,CAAAW,UAAA;QACA,MAAAC,OAAA,QAAApB,QAAA,CAAAqB,IAAA,CAAAD,OAAA,IAAAA,OAAA,CAAAd,EAAA,UAAAY,MAAA,CAAAV,MAAA,CAAAW,UAAA;QACAG,OAAA,CAAAC,GAAA,CAAAH,OAAA;QACA,IAAAA,OAAA;UACA,KAAA/B,eAAA,GAAA+B,OAAA;QACA;MACA;MACA,SAAAF,MAAA,CAAAV,MAAA,CAAAgB,mBAAA;QACA,KAAAlC,kBAAA,QAAA4B,MAAA,CAAAV,MAAA,CAAAgB,mBAAA;MACA;MACA,SAAAN,MAAA,CAAAV,MAAA,CAAAiB,QAAA;QACA,KAAAlC,aAAA,QAAA2B,MAAA,CAAAV,MAAA,CAAAiB,QAAA,CAAArB,GAAA,EAAAE,EAAA,EAAAoB,KAAA;UACApB,EAAA,EAAAA,EAAA;UACAC,KAAA,UAAAW,MAAA,CAAAV,MAAA,CAAAC,UAAA,CAAAiB,KAAA,UAAAR,MAAA,CAAAV,MAAA,CAAAE,aAAA,CAAAgB,KAAA;QACA;MACA;MACA,SAAAR,MAAA,CAAAV,MAAA,CAAAmB,gBAAA;QACA,KAAAnC,eAAA,QAAA0B,MAAA,CAAAV,MAAA,CAAAmB,gBAAA;MACA;IACA;IACAC,WAAAR,OAAA;MACA,KAAA/B,eAAA,GAAA+B,OAAA;IACA;IAEA,MAAAS,kBAAA;MACA,MAAAC,kBAAA;QACAxB,EAAA,OAAAY,MAAA,CAAAZ,EAAA;QACAE,MAAA;UACAmB,gBAAA,OAAAnC,eAAA;UACAgC,mBAAA,OAAAlC,kBAAA;UACA6B,UAAA,QAAA9B,eAAA,CAAAiB,EAAA;UACAmB,QAAA,OAAAlC,aAAA,CAAAa,GAAA,CAAAC,KAAA,IAAAA,KAAA,CAAAC,EAAA;QACA;MACA;MAEA;QACA,MAAAyB,QAAA,SAAA/C,aAAA,kBAAA8C,kBAAA;QACAR,OAAA,CAAAC,GAAA,yBAAAQ,QAAA;MACA,SAAAC,KAAA;QACAV,OAAA,CAAAU,KAAA,gCAAAA,KAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}